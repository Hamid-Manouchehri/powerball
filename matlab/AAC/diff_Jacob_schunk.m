
syms q1 q2 q3 q4 q5 q6 dq1 dq2 dq3 dq4 dq5 dq6 real

% Jacobian of Schunk:
J = [ ...
     (sin(q1)*(61*sin(q2-q3) + 70*sin(q2)))/200, -(cos(q1)*(61*cos(q2-q3) + 70*cos(q2)))/200, (61*cos(q2-q3)*cos(q1))/200, 0, 0, 0; ...
    -(cos(q1)*(61*sin(q2-q3) + 70*sin(q2)))/200, -(sin(q1)*(61*cos(q2-q3) + 70*cos(q2)))/200, (61*cos(q2-q3)*sin(q1))/200, 0, 0, 0; ...
     0, -(61*sin(q2-q3))/200 - (7*sin(q2))/20, (61*sin(q2-q3))/200, 0, 0, 0; ...
     0,  sin(q1), -sin(q1), -sin(q2-q3)*cos(q1), ...
        -cos(q4)*sin(q1) - cos(q1)*cos(q2)*cos(q3)*sin(q4) - cos(q1)*sin(q2)*sin(q3)*sin(q4), ...
         cos(q1)*cos(q2)*cos(q5)*sin(q3) - sin(q1)*sin(q4)*sin(q5) - cos(q1)*cos(q3)*cos(q5)*sin(q2) + cos(q1)*cos(q2)*cos(q3)*cos(q4)*sin(q5) + cos(q1)*cos(q4)*sin(q2)*sin(q3)*sin(q5); ...
     0, -cos(q1),  cos(q1), -sin(q2-q3)*sin(q1), ...
         cos(q1)*cos(q4) - cos(q2)*cos(q3)*sin(q1)*sin(q4) - sin(q1)*sin(q2)*sin(q3)*sin(q4), ...
         cos(q1)*sin(q4)*sin(q5) + cos(q2)*cos(q5)*sin(q1)*sin(q3) - cos(q3)*cos(q5)*sin(q1)*sin(q2) + cos(q2)*cos(q3)*cos(q4)*sin(q1)*sin(q5) + cos(q4)*sin(q1)*sin(q2)*sin(q3)*sin(q5); ...
     1, 0, 0, cos(q2-q3), -sin(q2-q3)*sin(q4), ...
         cos(q2)*cos(q3)*cos(q5) + cos(q5)*sin(q2)*sin(q3) - cos(q2)*cos(q4)*sin(q3)*sin(q5) + cos(q3)*cos(q4)*sin(q2)*sin(q5) ...
    ];

dJ_dt = diff(J,q1)*dq1 + diff(J,q2)*dq2 + diff(J,q3)*dq3 + ...
        diff(J,q4)*dq4 + diff(J,q5)*dq5 + diff(J,q6)*dq6;

% 4) Save as a function file
matlabFunction(dJ_dt, ...
               'File','dJ_dt_fun', ...
               'Vars',{[q1;q2;q3;q4;q5;q6],[dq1;dq2;dq3;dq4;dq5;dq6]});
