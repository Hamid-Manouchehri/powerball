function T = FK_schunk(Q)
    %   Q  : 6x1 (or 1x6) joint vector [q1..q6]
    %   a1,a2,a3,d6 : scalar link parameters used in the original C++ code
    %   T  : 3x4 matrix
    
    a1 = .205;
    a2 = .350;
    a3 = .305;
    d6 = .085+.155; % flang surface + gripper height

    q1 = Q(1); q2 = Q(2); q3 = Q(3); q4 = Q(4); q5 = Q(5); q6 = Q(6);
    
    T = [ ...
    cos(q6)*(cos(q1)*cos(q3)*sin(q2)*sin(q5) - cos(q1)*cos(q2)*sin(q3)*sin(q5) - cos(q5)*sin(q1)*sin(q4) + cos(q1)*cos(q2)*cos(q3)*cos(q4)*cos(q5) + cos(q1)*cos(q4)*cos(q5)*sin(q2)*sin(q3)) ...
     - sin(q6)*(cos(q4)*sin(q1) + cos(q1)*cos(q2)*cos(q3)*sin(q4) + cos(q1)*sin(q2)*sin(q3)*sin(q4)), ...
    - cos(q6)*(cos(q4)*sin(q1) + cos(q1)*cos(q2)*cos(q3)*sin(q4) + cos(q1)*sin(q2)*sin(q3)*sin(q4)) ...
     - sin(q6)*(cos(q1)*cos(q3)*sin(q2)*sin(q5) - cos(q1)*cos(q2)*sin(q3)*sin(q5) - cos(q5)*sin(q1)*sin(q4) + cos(q1)*cos(q2)*cos(q3)*cos(q4)*cos(q5) + cos(q1)*cos(q4)*cos(q5)*sin(q2)*sin(q3)), ...
    cos(q1)*cos(q2)*cos(q5)*sin(q3) - sin(q1)*sin(q4)*sin(q5) - cos(q1)*cos(q3)*cos(q5)*sin(q2) + cos(q1)*cos(q2)*cos(q3)*cos(q4)*sin(q5) + cos(q1)*cos(q4)*sin(q2)*sin(q3)*sin(q5), ...
    a3*cos(q1)*cos(q2)*sin(q3) - a2*cos(q1)*sin(q2) - a3*cos(q1)*cos(q3)*sin(q2) ...
     - d6*sin(q1)*sin(q4)*sin(q5) + d6*cos(q1)*cos(q2)*cos(q5)*sin(q3) - d6*cos(q1)*cos(q3)*cos(q5)*sin(q2) ...
     + d6*cos(q1)*cos(q4)*sin(q2)*sin(q3)*sin(q5) + d6*cos(q1)*cos(q2)*cos(q3)*cos(q4)*sin(q5); ...
    
    cos(q6)*(cos(q1)*cos(q5)*sin(q4) - cos(q2)*sin(q1)*sin(q3)*sin(q5) + cos(q3)*sin(q1)*sin(q2)*sin(q5) + cos(q2)*cos(q3)*cos(q4)*cos(q5)*sin(q1) + cos(q4)*cos(q5)*sin(q1)*sin(q2)*sin(q3)) ...
     - sin(q6)*(cos(q2)*cos(q3)*sin(q1)*sin(q4) - cos(q1)*cos(q4) + sin(q1)*sin(q2)*sin(q3)*sin(q4)), ...
    - cos(q6)*(cos(q2)*cos(q3)*sin(q1)*sin(q4) - cos(q1)*cos(q4) + sin(q1)*sin(q2)*sin(q3)*sin(q4)) ...
     - sin(q6)*(cos(q1)*cos(q5)*sin(q4) - cos(q2)*sin(q1)*sin(q3)*sin(q5) + cos(q3)*sin(q1)*sin(q2)*sin(q5) + cos(q2)*cos(q3)*cos(q4)*cos(q5)*sin(q1) + cos(q4)*cos(q5)*sin(q1)*sin(q2)*sin(q3)), ...
    cos(q1)*sin(q4)*sin(q5) + cos(q2)*cos(q5)*sin(q1)*sin(q3) - cos(q3)*cos(q5)*sin(q1)*sin(q2) + cos(q2)*cos(q3)*cos(q4)*sin(q1)*sin(q5) + cos(q4)*sin(q1)*sin(q2)*sin(q3)*sin(q5), ...
    a3*cos(q2)*sin(q1)*sin(q3) - a2*sin(q1)*sin(q2) - a3*cos(q3)*sin(q1)*sin(q2) ...
     + d6*cos(q1)*sin(q4)*sin(q5) + d6*cos(q2)*cos(q5)*sin(q1)*sin(q3) - d6*cos(q3)*cos(q5)*sin(q1)*sin(q2) ...
     + d6*cos(q2)*cos(q3)*cos(q4)*sin(q1)*sin(q5) + d6*cos(q4)*sin(q1)*sin(q2)*sin(q3)*sin(q5); ...
    
    - cos(q6)*(sin(q2)*sin(q3)*sin(q5) + cos(q2)*cos(q3)*sin(q5) + cos(q2)*cos(q4)*cos(q5)*sin(q3) - cos(q3)*cos(q4)*cos(q5)*sin(q2)) ...
     - sin(q2 - q3)*sin(q4)*sin(q6), ...
      sin(q6)*(sin(q2)*sin(q3)*sin(q5) + cos(q2)*cos(q3)*sin(q5) + cos(q2)*cos(q4)*cos(q5)*sin(q3) - cos(q3)*cos(q4)*cos(q5)*sin(q2)) ...
     - sin(q2 - q3)*cos(q6)*sin(q4), ...
    cos(q2)*cos(q3)*cos(q5) + cos(q5)*sin(q2)*sin(q3) - cos(q2)*cos(q4)*sin(q3)*sin(q5) + cos(q3)*cos(q4)*sin(q2)*sin(q5), ...
    a1 + a2*cos(q2) + a3*cos(q2)*cos(q3) + a3*sin(q2)*sin(q3) ...
     + d6*cos(q2)*cos(q3)*cos(q5) + d6*cos(q5)*sin(q2)*sin(q3) - d6*cos(q2)*cos(q4)*sin(q3)*sin(q5) + d6*cos(q3)*cos(q4)*sin(q2)*sin(q5) ...
    ];
end